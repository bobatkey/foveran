– catamorphisms for indexed data
drop : (I : Set) ->
       (D : I -> IDesc I) ->
       (A : I -> Set) ->
       (i : I) ->
       (x : semI[D i, i. µI I D i]) ->
       liftI I (D i) (λi. µI I D i) (λi x. A i) x ->
       semI[D i, i. A i]
drop I D A i =
  elimID I
    (λD'. (x : semI[D', i. µI I D i]) ->
          liftI I D' (λi. µI I D i) (λi x. A i) x ->
          semI[D', i. A i])
    (λi x a. a)
    (λX x u. x)
    (λD₁ D₂ drop₁ drop₂ x a.
      «drop₁ (fst x) (fst a), drop₂ (snd x) (snd a)»)
    (λX D drop x a. «fst x, drop (fst x) (snd x) a»)
    (λX D drop f a. λx. drop x (f x) (a x))
    (D i);

icata : (I : Set) ->
        (D : I -> IDesc I) ->
        (A : I -> Set) ->
        ((i : I) -> semI[D i, i. A i] -> A i) ->
        (i : I) -> µI I D i -> A i;
icata I D A k =
  inductionI I D
    (λi x. A i)
    (λi x φ. k i (drop I D A i x φ));
