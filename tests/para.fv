sem : Desc â†’ Set â†’ Set ;
sem = elimD (Î»x. Set â†’ Set)
            (Î»A X. A)
            (Î»X. X)
            (Î»F G semF semG X. semF X Ã— semG X)
            (Î»F G semF semG X. semF X + semG X);

lift : (D : Desc) â†’
       (Î± : Set) â†’
       (Î¦ : Î± â†’ Set 2) â†’
       sem D Î± â†’
       Set 2 ;
lift D Î± Î¦ = elimD (\D. sem D Î± â†’ Set 2)
                   (\A x. Unit)
                   (\x. Î¦ x)
                   (\F G f g x. f (fst x) Ã— g (snd x))
                   (\F G f g x. case x for d. Set 2 with
                                   { inl y. f y
                                   ; inr z. g z
                                   })
                   D;

data Ty : Set :=
  | v   :
  | arr : Ty Ty
  ;

Ty-induction : (Î¦ : Ty â†’ Set 2) â†’
               Î¦ v â†’
               ((tâ‚ tâ‚‚ : Ty) â†’ Î¦ tâ‚ â†’ Î¦ tâ‚‚ â†’ Î¦ (arr tâ‚ tâ‚‚)) â†’
               (t : Ty) â†’ Î¦ t;
Ty-induction Î¦ Ï†v Ï†arr = induction TyDesc Î¦
                                   (Î»x. case x for x. lift TyDesc Ty Î¦ x â†’ Î¦ (construct x) with
                                           { inl u. Î»u'. Ï†v
                                           ; inr tâ‚tâ‚‚. Î»ihâ‚ihâ‚‚. Ï†arr (fst tâ‚tâ‚‚) (snd tâ‚tâ‚‚) (fst ihâ‚ihâ‚‚) (snd ihâ‚ihâ‚‚)
                                           });

data Ctxt : Set :=
  | emp  :
  | cons : Ty Ctxt
  ;

Ctxt-induction : (Î¦ : Ctxt â†’ Set 2) â†’
                 Î¦ emp â†’
                 ((Ï„ : Ty) â†’ (Î“ : Ctxt) â†’ Î¦ Î“ â†’ Î¦ (cons Ï„ Î“)) â†’
                 (Î“ : Ctxt) â†’ Î¦ Î“;
Ctxt-induction Î¦ Ï†emp Ï†cons = induction CtxtDesc Î¦
                                        (Î»x. case x for x. lift CtxtDesc Ctxt Î¦ x â†’ Î¦ (construct x) with
                                                { inl u. Î»u'. Ï†emp
                                                ; inr Î“Ï„. Î»ih. Ï†cons (fst Î“Ï„) (snd Î“Ï„) (snd ih)
                                                });

ty-sem : Ty â†’ Set â†’ Set ;
ty-sem ty Î± = Ty-induction (Î»x. Set)
                           Î±
                           (Î»tâ‚ tâ‚‚ sem-tâ‚ sem-tâ‚‚. sem-tâ‚ â†’ sem-tâ‚‚)
                           ty;

ctxt-sem : Ctxt â†’ Set â†’ Set ;
ctxt-sem Î“ Î± = Ctxt-induction (Î»x. Set) ğŸ™ (Î»Ï„ Î“ Î“-sem. ty-sem Ï„ Î± Ã— Î“-sem) Î“;

ty-pred : (Ï„ : Ty) â†’ (Î± : Set) â†’ (Î¦ : Î± â†’ Set) â†’ ty-sem Ï„ Î± â†’ Set ;
ty-pred Ï„ Î± Î¦ = Ty-induction (Î»Ï„. ty-sem Ï„ Î± â†’ Set)
                             (Î»a. Î¦ a)
                             (Î»Ï„â‚ Ï„â‚‚ Ï†â‚ Ï†â‚‚ f. (a : ty-sem Ï„â‚ Î±) â†’ Ï†â‚ a â†’ Ï†â‚‚ (f a))
                             Ï„;

ctxt-pred : (Î“ : Ctxt) â†’ (Î± : Set) â†’ (Î¦ : Î± â†’ Set) â†’ ctxt-sem Î“ Î± â†’ Set ;
ctxt-pred Î“ Î± Î¦ = Ctxt-induction (Î»Î“. ctxt-sem Î“ Î± â†’ Set)
                                 (Î»u. Unit)
                                 (Î»Ï„ Î“ Ï† Î³. ty-pred Ï„ Î± Î¦ (fst Î³) Ã— Ï† (snd Î³))
                                 Î“;

assume param : (Î“ : Ctxt) â†’
               (Ï„ : Ty) â†’
               (x : (Î± : Set) â†’ ctxt-sem Î“ Î± â†’ ty-sem Ï„ Î±) â†’
               (Î± : Set) â†’
               (Î¦ : Î± â†’ Set) â†’
               (Î³ : ctxt-sem Î“ Î±) â†’
               ctxt-pred Î“ Î± Î¦ Î³ â†’
               ty-pred Ï„ Î± Î¦ (x Î± Î³);

church-nat : Set 1;
church-nat = (Î± : Set) â†’ Î± â†’ (Î± â†’ Î±) â†’ Î±;

zero : church-nat ;
zero Î± z s = z;

succ : church-nat â†’ church-nat ;
succ n Î± z s = s (n Î± z s);


â€“ interestingly, we can't do induction over church-nat to prove a
â€“ predicate on church-nats. This would require impredicativity?
â€“ this isn't surprising.
church-nat-induction : (Î± : Set) â†’
                       (z : Î±) â†’
                       (s : Î± â†’ Î±) â†’
                       (Î¦ : Î± â†’ Set) â†’
                       (Î¦ z) â†’
                       ((n : Î±) â†’ Î¦ n â†’ Î¦ (s n)) â†’
                       (n : church-nat) â†’ Î¦ (n Î± z s);
church-nat-induction Î± z s Î¦ Ï†z Ï†s n =
   param emp (arr v (arr (arr v v) v))
         (Î»Î± u. n Î±)
         Î±
         Î¦
         â‹„
         â‹„
         z Ï†z
         s Ï†s;
